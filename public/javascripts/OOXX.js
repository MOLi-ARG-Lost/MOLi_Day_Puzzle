var game=(()=>{var e,l,t,n,r="X",a=!0,o=0,i=2,s=!1,c=void 0,d=void 0,u=void 0,f={},h=(e=0)=>new Promise(l=>setTimeout(l,e));function p(o,i){if(o.innerHTML=i,i===r&&$("#"+o.id).addClass("player-two"),$("#"+o.id).addClass("cannotuse"),function(l){t=l.id[4],n=l.id[5],e=!0;for(var r=0;r<3;r++)$("#cell"+r+n).text()!==l.innerHTML&&(e=!1);if(e){for(var r=0;r<3;r++)$("#cell"+r+n).addClass("wincell");return}e=!0;for(var r=0;r<3;r++)$("#cell"+t+r).text()!==l.innerHTML&&(e=!1);if(e){for(var r=0;r<3;r++)$("#cell"+t+r).addClass("wincell");return}e=!0;for(var r=0;r<3;r++)$("#cell"+r+r).text()!==l.innerHTML&&(e=!1);if(e){for(var r=0;r<3;r++)$("#cell"+r+r).addClass("wincell");return}e=!1,$("#cell02").text()===l.innerHTML&&$("#cell11").text()===l.innerHTML&&$("#cell20").text()===l.innerHTML&&(e=!0,$("#cell02").addClass("wincell"),$("#cell11").addClass("wincell"),$("#cell20").addClass("wincell"))}(o),e){$(".cell").unbind("mouseenter").unbind("mouseleave"),confirm('You Win Huh? Here is you code: "'+c+'" As usually, keep it in mind.')?(alert("Wrong choice. But the browser is gradually become weird"),h(5e3),location.replace("/"+u)):(alert("Right choice. But make sure you got the weird thing in this page."),h(1e3),location.replace("/"+d))}l++,e||l>=6?($("#restart").addClass("btn-green"),$(".cell").addClass("cannotuse")):a&&l%2!=0&&async function(){var e=!1;for(;!e;)t=Math.floor(3*Math.random()),n=Math.floor(3*Math.random()),""===$("#cell"+t+n).text()&&(e=!0);await h(50),$("#cell"+t+n).click()}()}function C(){o=0,l=0,e=!1,$(".cell").text(""),$(".cell").removeClass("wincell"),$(".cell").removeClass("cannotuse"),$(".cell").removeClass("player-two"),$("#restart").removeClass("btn-green")}return f.init=(()=>{$("#game-screen").fadeIn(1e3),C(),$("#sendOut").on("click",function(){!function(){if(s)alert('You already got "O"!');else{$("#secretCode").prop("disabled",!0),$("#sendOut").prop("disabled",!0);let e=0;fetch("/_api/check/OOXX",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({secretCode:$("#secretCode").val()})}).then(l=>(e=l.status,l.json())).then(l=>{200===e&&(alert(l.message),c=l.storyCode,d=l.nextUrl,u=l.terminal,i++,s=!0),403===e&&(alert(l.message),$("#secretCode").prop("disabled",!1),$("#sendOut").prop("disabled",!1))}).catch(e=>{alert("網路錯誤，請重新再試"),$("#secretCode").prop("disabled",!1),$("#sendOut").prop("disabled",!1),console.log("Network Error: ",e)})}}()}),$("#restart").on("click",function(){C()}),$(".cell").on("click",function(){e||""!==this.innerHTML||(l%2==0?o<i?(p(this,"O"),o++):3===i?alert("You lose your chance to win, try again."):alert('Your haven\'t enough "O", try to find it.'):p(this,r))})}),f})();